<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanatsal Ä°zi OluÅŸturucu</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Genel stil ayarlarÄ± */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }
        /* Kontrol panelinin gÃ¶rÃ¼nÃ¼mÃ¼ */
        .controls {
            background: #1e1e1e;
            padding: 30px;
            border-radius: 16px;
            width: 100%;
            max-width: 450px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        /* GiriÅŸ alanlarÄ± ve butonlar iÃ§in genel stil */
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #aaa;
        }
        .control-group input,
        .control-group select,
        .control-group button {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: #2d2d2d;
            color: #fff;
            font-size: 1rem;
            box-sizing: border-box;
        }
        /* Renk seÃ§icinin gÃ¶rÃ¼nÃ¼mÃ¼ */
        input[type="color"] {
            padding: 0;
            height: 40px;
            cursor: pointer;
        }
        /* Buton stilleri */
        .btn-create {
            background-color: #00c853;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .btn-create:hover {
            background-color: #00e676;
        }
        .btn-download {
            background-color: #ff4081;
            color: white;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.2s;
            display: none; /* BaÅŸlangÄ±Ã§ta gizli */
        }
        .btn-download:hover {
            background-color: #f50057;
        }
        /* Ã–nizleme alanÄ± */
        .preview-container {
            padding: 10px;
            background: white;
            border-radius: 12px;
            display: none; /* BaÅŸlangÄ±Ã§ta gizli */
        }
        canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>

    <div class="controls">
        <h2 style="text-align: center; color: #00c853;">ðŸŽ¨ Sanatsal Ä°z OluÅŸturucu</h2>
        
        <div class="control-group">
            <label for="linkInput">ðŸ”— GÃ¶mÃ¼lecek Link:</label>
            <input type="text" id="linkInput" placeholder="https://..." value="https://example.com">
        </div>

        <div class="control-group">
            <label for="colorInput">ðŸŽ¨ Ä°z Rengi:</label>
            <input type="color" id="colorInput" value="#000000">
        </div>

        <div class="control-group">
            <label for="styleInput">ðŸŒ€ Tarz SeÃ§in:</label>
            <select id="styleInput">
                <option value="fingerprint">Parmak Ä°zi</option>
                <option value="ink-splatter">MÃ¼rekkep Lekesi</option>
            </select>
        </div>

        <button class="btn-create" onclick="generateArt()">âœ¨ Ä°zi OluÅŸtur</button>
        <button class="btn-download" id="dlBtn" onclick="downloadPDF()">ðŸ’¾ 40x30cm PDF Ä°ndir (300 DPI)</button>
    </div>

    <div class="preview-container" id="previewContainer">
        <canvas id="previewCanvas"></canvas>
    </div>

    <script>
        const PRINT_W = 4724; // 40cm @ 300 DPI
        const PRINT_H = 3543; // 30cm @ 300 DPI
        let uniqueID = '';
        let currentStyle = 'fingerprint';

        function generateArt() {
            const link = document.getElementById('linkInput').value;
            if (!link) {
                alert("LÃ¼tfen bir link girin.");
                return;
            }

            uniqueID = Date.now().toString(36);
            currentStyle = document.getElementById('styleInput').value;
            
            const previewCanvas = document.getElementById('previewCanvas');
            const previewContainer = document.getElementById('previewContainer');
            const dlBtn = document.getElementById('dlBtn');

            // Ã–nizleme iÃ§in canvas boyutunu ayarla
            previewCanvas.width = 800;
            previewCanvas.height = 600;

            // SeÃ§ilen stile gÃ¶re Ã§izim yap
            if (currentStyle === 'fingerprint') {
                drawFingerprint(previewCanvas, 800, 600, uniqueID);
            } else {
                drawInkSplatter(previewCanvas, 800, 600, uniqueID);
            }

            previewContainer.style.display = 'block';
            dlBtn.style.display = 'block';
        }

        // Parmak izi Ã§izim fonksiyonu
        function drawFingerprint(canvas, width, height, seed) {
            const ctx = canvas.getContext('2d');
            const color = document.getElementById('colorInput').value;

            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);

            ctx.strokeStyle = color;
            ctx.lineWidth = width / 150;
            ctx.lineCap = 'round';

            const centerX = width / 2;
            const centerY = height / 2;
            const maxRadius = Math.min(width, height) * 0.4;
            const numRings = 25;

            // Rastgelelik iÃ§in seed'i kullan
            let rng = new Math.seedrandom(seed);

            for (let i = 1; i <= numRings; i++) {
                const radius = (i / numRings) * maxRadius;
                const startAngle = rng() * Math.PI * 2;
                const endAngle = startAngle + (Math.PI * 1.5) + (rng() * Math.PI * 0.5);
                const counterclockwise = rng() > 0.5;

                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, startAngle, endAngle, counterclockwise);
                ctx.stroke();

                // Rastgele kÃ¼Ã§Ã¼k kesintiler ve sapmalar ekle
                if (rng() > 0.7) {
                    const breakAngle = startAngle + (rng() * (endAngle - startAngle));
                    const breakX = centerX + Math.cos(breakAngle) * radius;
                    const breakY = centerY + Math.sin(breakAngle) * radius;
                    ctx.clearRect(breakX - 2, breakY - 2, 4, 4);
                }
            }
        }

        // MÃ¼rekkep lekesi Ã§izim fonksiyonu
        function drawInkSplatter(canvas, width, height, seed) {
            const ctx = canvas.getContext('2d');
            const color = document.getElementById('colorInput').value;

            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);

            ctx.fillStyle = color;
            const centerX = width / 2;
            const centerY = height / 2;
            const numDrops = 50;
            let rng = new Math.seedrandom(seed);

            for (let i = 0; i < numDrops; i++) {
                const angle = rng() * Math.PI * 2;
                const distance = rng() * Math.min(width, height) * 0.4;
                const x = centerX + Math.cos(angle) * distance;
                const y = centerY + Math.sin(angle) * distance;
                const radius = (rng() * width / 20) * (1 - distance / (Math.min(width, height) * 0.4));

                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        async function downloadPDF() {
            const dlBtn = document.getElementById('dlBtn');
            dlBtn.innerText = "â³ PDF HazÄ±rlanÄ±yor...";
            dlBtn.disabled = true;

            const highResCanvas = document.createElement('canvas');
            highResCanvas.width = PRINT_W;
            highResCanvas.height = PRINT_H;

            if (currentStyle === 'fingerprint') {
                drawFingerprint(highResCanvas, PRINT_W, PRINT_H, uniqueID);
            } else {
                drawInkSplatter(highResCanvas, PRINT_W, PRINT_H, uniqueID);
            }

            const imgData = highResCanvas.toDataURL('image/png', 1.0);

            const { jsPDF } = window.jspdf;
            // 400mm x 300mm boyutunda PDF oluÅŸtur
            const pdf = new jsPDF({
                orientation: 'landscape',
                unit: 'mm',
                format: [400, 300]
            });

            // GÃ¶rÃ¼ntÃ¼yÃ¼ PDF'e ekle
            pdf.addImage(imgData, 'PNG', 0, 0, 400, 300);
            
            // PDF'i indir
            pdf.save(`Sanatsal_Iz_${uniqueID}.pdf`);

            dlBtn.innerText = "ðŸ’¾ 40x30cm PDF Ä°ndir (300 DPI)";
            dlBtn.disabled = false;
        }

        // Rastgele sayÄ± Ã¼reteci iÃ§in kÃ¼tÃ¼phane (harici script olarak eklenmeli)
        (function(a,b,c,d,e,f){a.Math.seedrandom=function(g,h,i){return h=h||{},h.a=h.a||1103515245,h.c=h.c||12345,i=i||a.Math.random,g=g||i(),function(){return g=g*h.a+h.c&2147483647}}})(window);
    </script>
</body>
</html>
